---
toc: true
toc_label: "Linux çš„ä½¿ç”¨ - ç³»ç»Ÿèµ„æºé…ç½®"
toc_icon: "laptop"
title: "Linux çš„ä½¿ç”¨ - ç³»ç»Ÿèµ„æºé…ç½®"
tags: linux é™é¢ é…é¢ é™åˆ¶
categories: "tools"
classes: wide
excerpt: "å¯¹ç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„ç³»ç»Ÿèµ„æºè¿›è¡Œé™åˆ¶"
header:
  overlay_image: /assets/images/header/linux.jpg
  overlay_filter: rgba(0, 0, 0, 0.6)
---



## èµ„æºé…é¢å¸¸ç”¨å·¥å…·




### `ulimit`

`ulimit` å·¥å…·å¯ä»¥ **å¯¹ç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„ç³»ç»Ÿèµ„æºè¿›è¡Œé™åˆ¶**ï¼Œå¦‚ **æ‰“å¼€çš„æ–‡ä»¶æ•°é‡ã€CPU æ—¶é—´ã€å†…å­˜æ€»é‡** ç­‰ã€‚



#### è¯­æ³•

`ulimit -SHacdfltu [é…é¢]`

`-H`  ç¡¬æŒ‡æ ‡ï¼Œä¸èƒ½è¶…è¿‡æ­¤å€¼

`-S`  è½¯æŒ‡æ ‡ï¼Œå¯ä»¥è¶…è¿‡æ­¤å€¼ï¼Œè¶…è¿‡ä¼šæœ‰è­¦å‘Šä¿¡æ¯

é€šå¸¸è½¯æŒ‡æ ‡æ¯”ç¡¬æŒ‡æ ‡å°ï¼Œè¾¾åˆ°å…ˆè­¦å‘Šå†é™åˆ¶çš„æ•ˆæœ

`-a`  åé¢ä¸æ¥ä»»ä½•é€‰é¡¹ä¸å‚æ•°ï¼Œå¯åˆ—å‡ºæ‰€æœ‰çš„é™åˆ¶é¢åº¦

`-c`  é™åˆ¶æ¯ä¸ªå†…æ ¸æ–‡ä»¶çš„å¤§å°

ç¨‹åºå‡ºé”™æ—¶ï¼Œç³»ç»Ÿå°†è¯¥ç¨‹åºåœ¨å†…å­˜ä¸­çš„ä¿¡æ¯å†™æˆå†…æ ¸æ–‡ä»¶ï¼Œä¾¿äºé™¤é”™ã€‚

`-f`  å½“å‰ shell å¯ä»¥åˆ›å»ºæ–‡ä»¶çš„å®¹é‡é™åˆ¶

å•ä½ä¸º KBytesï¼Œä¸€èˆ¬ä¸º 2GB

`-d`  ç¨‹åºå¯ä½¿ç”¨çš„æœ€å¤§æ–­è£‚å†…å­˜ï¼ˆsegmentï¼‰å®¹é‡ï¼›

`-l`  å¯ç”¨äºé”å®šçš„å†…å­˜é‡

`-t`  å¯ä½¿ç”¨çš„æœ€å¤§ CPU æ—¶é—´ ï¼ˆç§’ï¼‰

`-u`  å•ä¸€ç”¨æˆ·å¯ä»¥ä½¿ç”¨çš„æœ€å¤§è¿›ç¨‹æ•°é‡ã€‚




#### èŒƒä¾‹

* æŸ¥çœ‹å½“å‰æ™®é€šç”¨æˆ·èº«ä»½çš„æ‰€æœ‰é…é¢

`ulimit -a`

é…é¢ä¸º 0 è¡¨ç¤ºæ²¡é™åˆ¶

* é™åˆ¶ç”¨æˆ·ä»…èƒ½åˆ›å»º 10 MBytes ä»¥ä¸‹çš„æ–‡ä»¶

`ulimit -f 10240`

ğŸ“• æ¢å¤ ulimit çš„è®¾ç½®åªéœ€ **é‡æ–°ç™»é™†**ã€‚

ğŸ“• å¦‚æœæ™®é€šç”¨æˆ·ä½¿ç”¨ ulimit è®¾ç½®äº†çš„æ–‡ä»¶å¤§å°é…é¢ï¼Œä»–åæœŸåªå…è®¸ **ç»§ç»­é™ä½** æ­¤é…é¢ï¼Œæ— æƒæå‡ã€‚










### `xfs_quota`



#### è¯­æ³•

`xfs_quota` ç”¨äºç”Ÿæˆé…é¢çš„è¯¦ç»†æŠ¥å‘Šï¼Œè®¾ç½®å„ç§é…é¢å‚æ•°ã€‚

`xfs_quota -x -c "å­å‘½ä»¤" [æŒ‚è½½ç‚¹]`

`-x`   ä¸“å®¶æ¨¡å¼ï¼Œç”¨äºæ¥ `-c å­å‘½ä»¤`

`-c`   æ¥ **å­å‘½ä»¤**

##### ç”¨æˆ·å­å‘½ä»¤

`print`  æŸ¥çœ‹å½“å‰ä¸»æœºå†…çš„æ–‡ä»¶ç³»ç»Ÿã€å¯¹åº”çš„è·¯å¾„

`df`  ä¸ df åŠŸèƒ½ç›¸åŒï¼Œå¯ä»¥åŠ ä¸Š -bï¼ˆblockï¼‰-iï¼ˆinodeï¼‰-hï¼ˆåŠ ä¸Šå•ä½ï¼‰

`report`  åˆ—å‡ºç›®å‰çš„é…é¢é¡¹ç›®ï¼Œå¯æ¥ -ugr ï¼ˆuser/group/projectï¼‰ åŠ -bi ç­‰å‚æ•°

`state`  æŸ¥çœ‹å½“å‰å…·ä½“çš„é…é¢è®¾ç½®

##### ç®¡ç†å‘˜å­å‘½ä»¤

`disable`  æš‚æ—¶ç¦ç”¨é…é¢çš„é™åˆ¶ã€‚å…¶å®ç³»ç»Ÿè¿˜æ˜¯åœ¨è®¡ç®—é…é¢ï¼Œåªæ˜¯æ²¡æœ‰ç®¡åˆ¶ã€‚

`enable`  å¯ç”¨é…é¢é™åˆ¶ï¼Œæ¢å¤æ­£å¸¸ç®¡åˆ¶ã€‚

`off`  é’ˆå¯¹æ–‡ä»¶ç³»ç»Ÿå®Œå…¨å…³é—­æŸç±»é…é¢çš„é™åˆ¶ã€‚åªæœ‰å¸è½½ã€é‡æ–°æŒ‚è½½æ‰èƒ½å†æ¬¡å¯ç”¨é…é¢ã€‚

`remove`  æ¸…é™¤æ‰€æœ‰é…é¢è®¾ç½®ï¼Œå¿…é¡»åœ¨ off çŠ¶æ€ä¸‹è¿›è¡Œã€‚




#### èŒƒä¾‹

##### æš‚æ—¶ç¦ç”¨é…é¢

`xfs_quota -x -c "disable -up" /home`

##### é‡æ–°æ¢å¤é…é¢

`xfs_quota -x -c "enable -up" /home`

##### å…³é—­æ–‡ä»¶ç³»ç»Ÿé¡¹ç›®é…é¢é™åˆ¶

`xfs_quota -x -c "off -p" /home`

##### æ¸…é™¤æŸç±»é…é¢

è¦å…ˆä½¿ç”¨ `off` å­å‘½ä»¤æ¥å…³é—­è¯¥ç±»é…é¢ï¼Œç„¶åå†ç”¨ `remove` æ¸…é™¤ã€‚

`xfs_quota -x -c "off -u" /home`   å…³é—­ç”¨æˆ·é…é¢é™åˆ¶

`xfs_quota -x -c "remove -u" /home`   æ¸…é™¤ç”¨æˆ·é…é¢è®¾ç½®

`remove` ä¼šæ¸…é™¤æ‰€æœ‰ç”¨æˆ·æˆ–æ‰€æœ‰é¡¹ç›®çš„é…é¢ï¼Œæ— æ³•é’ˆå¯¹ç‰¹å®šç”¨æˆ·æˆ–é¡¹ç›®å•ç‹¬æ¸…é™¤ã€‚

##### æŸ¥çœ‹å½“å‰å„æ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½å‚æ•°

`xfs_quota -x -c "print"`

##### æŸ¥çœ‹ `/home` çš„ç£ç›˜ä½¿ç”¨ç‡

`xfs_quota -x -c "df -h" /home`

##### æŸ¥çœ‹ç›®å½•ä¸­æ‰€æœ‰ç”¨æˆ·çš„é…é¢

`xfs_quota -x -c "report -ubih" /home`

##### æŸ¥çœ‹å½“å‰æ–‡ä»¶ç³»ç»Ÿå…·ä½“çš„é…é¢è®¾ç½®

`xfs_quota -x -c "state"`

##### é’ˆå¯¹ç”¨æˆ·è®¾ç½®å—é…é¢

`xfs_quota -x -c "limit -u bsoft=250M bhard=300M myquota1" /home`

##### é’ˆå¯¹ç»„è®¾ç½®å—é…é¢

`xfs_quota -x -c "limit -g bsoft=950M bhard=1G myquotagrp" /home`

##### è®¾ç½®å®½é™æ—¶é—´

`xfs_quota -x -c "timer -ug -b 14days" /home`

##### ç”Ÿæˆé¡¹ç›®é…ç½®æ–‡ä»¶

`echo "myquotaproject:11" >> /etc/projid`

##### é¡¹ç›®åˆå§‹åŒ–

`xfs_quota -x -c "project -s myquotaproject"`

##### è®¾ç½®é¡¹ç›®é…é¢

`xfs_quota -x -c "limit -p bsoft=450M bhard=500M myquotaproject" /home`
